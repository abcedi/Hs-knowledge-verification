<!doctype html>
<html>
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quiz Results</title>

  <style>
    body {
      margin: 0;
      padding: 18px;
      font-family: system-ui, -apple-system, Arial;
      background: #0f0f0f;
      color: #fff;
    }

    h1 { margin: 0 0 12px 0; }

    .card {
      border: 1px solid #2a2a2a;
      border-radius: 14px;
      padding: 16px;
      background: #141414;
      max-width: 720px;
    }

    .muted { opacity: 0.8; font-size: 13px; margin-top: 6px; }

    .big {
      font-size: 28px;
      font-weight: 800;
      margin: 10px 0 6px 0;
    }

    .row {
      display: flex;
      gap: 12px;
      flex-wrap: wrap;
      margin-top: 12px;
    }

    .pill {
      display: inline-block;
      padding: 6px 10px;
      border: 1px solid #444;
      border-radius: 999px;
      font-size: 12px;
      opacity: 0.95;
    }

    .ok { color: #67ff9b; }
    .bad { color: #ff6b6b; }

    a, button {
      display: inline-block;
      margin-top: 14px;
      padding: 12px 14px;
      border-radius: 12px;
      font-size: 15px;
      text-decoration: none;
      border: none;
      cursor: pointer;
      touch-action: manipulation;
    }

    a.primary {
      background: #1e90ff;
      color: #fff;
    }

    a.secondary {
      background: #333;
      color: #fff;
      margin-left: 10px;
    }

    pre {
      white-space: pre-wrap;
      margin: 0;
      font-size: 14px;
      line-height: 1.35;
    }
  </style>
</head>

<body>
  <h1>Results</h1>

  <div class="card">
    <div id="headline" class="pill">Loading…</div>
    <div id="scoreBig" class="big">—</div>

    <div class="row">
      <div class="pill" id="scorePill">Score: —</div>
      <div class="pill" id="wrongPill">Wrong: —</div>
      <div class="pill" id="percentPill">Percent: —</div>
    </div>

    <div class="muted" id="detail">—</div>

    <div style="margin-top: 12px;">
      <pre id="out">Loading…</pre>
    </div>

    <a class="primary" href="quiz.html">Take quiz again</a>
    <a class="secondary" href="index.html">Back to login</a>
  </div>

  <script>
    const out = document.getElementById("out");
    const headline = document.getElementById("headline");
    const scoreBig = document.getElementById("scoreBig");
    const scorePill = document.getElementById("scorePill");
    const wrongPill = document.getElementById("wrongPill");
    const percentPill = document.getElementById("percentPill");
    const detail = document.getElementById("detail");

    const params = new URLSearchParams(window.location.search);

    const status = params.get("status") || "unknown";
    const score = Number(params.get("score") || 0);
    const total = Number(params.get("total") || 0);
    const wrong = Number(params.get("wrong") || 0);
    const err = params.get("err");

    function pct(s, t) {
      if (!t) return 0;
      return Math.round((s / t) * 100);
    }

    if (status === "ok") {
      const p = pct(score, total);

      headline.textContent = "Saved ✅";
      headline.classList.add("ok");

      scoreBig.textContent = `${p}%`;

      scorePill.textContent = `Score: ${score} / ${total}`;
      wrongPill.textContent = `Wrong: ${wrong}`;
      percentPill.textContent = `Percent: ${p}%`;

      detail.textContent = "Your attempt was saved to Firestore. Admin dashboard will include this result.";

      out.textContent =
        `Saved ✅\n` +
        `Score: ${score} / ${total}\n` +
        `Wrong: ${wrong}\n` +
        `Percent: ${p}%`;

    } else {
      headline.textContent = "Not saved ❌";
      headline.classList.add("bad");

      scoreBig.textContent = "—";
      scorePill.textContent = "Score: —";
      wrongPill.textContent = "Wrong: —";
      percentPill.textContent = "Percent: —";

      detail.textContent = "This attempt did not save. Try submitting again from the quiz page.";

      out.textContent = `Not saved ❌\n${err || "Unknown error"}`;
    }
  </script>
</body>
</html>
